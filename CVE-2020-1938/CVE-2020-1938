# Apache Tomcat CVE-2020-1938

[TOC]

# 1. 概述

## 1.1 Apache Tomcat

Tomcat服务器是一个免费的开放源代码的Web应用服务器，被普遍使用在轻量级Web应用服务的构架中。 Tomcat提供了可以在其中运行Java代码的“纯Java” HTTP Web服务器环境。

## 1.2 漏洞简述

CVE-2020-1938是由长亭科技安全研究员发现的存在于 Tomcat 中的安全漏洞，由于 Tomcat AJP 协议设计上存在缺陷，攻击者通过 Tomcat AJP Connector 可以读取或包含 Tomcat 上所有 webapp 目录下的任意文件，例如可以读取 webapp 配置文件或源代码。此外在目标应用有文件上传功能的情况下，配合文件包含的利用还可以达到远程代码执行的危害。

## 1.3 风险等级

|  评定方式   | 等级  |
|  ----  | ----  |
| CVSS Score | 7.5 |
| Confidentiality Impact  | Partial |
| Integrity Impact  | Partial |
| Availability Impact  | Partial |
| 实现难度  | 低 |
| 基础权限  | 不需要 |
| 漏洞类型  | Execute Code |

![cvss](./img/cvss.png)

## 1.4 影响范围

![cvss](./img/Afted.png)

## 1.5 漏洞详情



# 2. 环境配置

## 2.1 方案一

## 2.2 方案二

## 2.3 访问测试


# 3. 漏洞复现


## 3.1 准备工作



### 准备Payload




## 3.2 漏洞利用



# 4. 修复建议

1. 临时禁用AJP协议端口，在conf/server.xml配置文件中注释掉<Connector port=“8009” protocol="AJP/1.3"redirectPort=“8443” />
2. 将tomcat升级到9.0.31、8.5.51或者7.0.100版本
3. 配置secret来设置AJP协议的认证凭证

# 5. 总结



# 6. References

CVE Details (2020) _CVE-2020-9496_. Available at: https://www.cvedetails.com/cve/CVE-2020-9496/...(Accessed: 22 Sept 2022).


